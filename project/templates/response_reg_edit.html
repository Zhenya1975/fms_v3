
<form method="POST" action="{{ url_for('home.registration_edit', reg_id = reg_data.reg_id) }}">
    {{ form.csrf_token }}

<div class="row">
    <div class="col d-flex justify-content-start">
            <div class="row">
                <div class="col">
                    <img src= {{ reg_data.registration_participant.fighter_image }} class="float-left" alt="Responsive image" width="100" height="100">
                </div>
                <div class="col">
                    <h5>{{ reg_data.registration_participant.participant_last_name }} {{ reg_data.registration_participant.participant_first_name }} </h5>
                </div>


            </div> <!-- конец дива с левым участником-->
    </div> <!--конец левой колонкя для левого участника -->

</div>





    <p>Вес и весовая категория</p>
    <div class="form-row">
    <div class="col-3">

      <input class="form-control weight_value_at_reg" type="number" id="myTextBox" name="weight_input" value="{{ reg_data.weight_value }}" placeholder="Вес, кг">


    </div>
    <div class="col-9">

      <div class="input-group mb-3">

          <select class="weight_category_select form-control" id="weight_cat_select" name="weight_catagory_selector">
              {% for weight_cat in weight_categories_data %}
                <option value={{ weight_cat.weight_cat_id }}>{{ weight_cat.weight_category_name }}</option>
              {% endfor %}

        </select>


        <div class="input-group-append">
            <button class="btn btn-outline-secondary update_weight_cat" type="button">Обновить</button>
          </div>
    </div>

    </div>
  </div>



    <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Закрыть</button>
        <button type="submit" class="btn btn-primary">Сохранить</button>
    </div>


</form>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
<!--    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.3.0/socket.io.js" integrity="sha256-bQmrZe4yPnQrLTY+1gYylfNMBuGfnT/HKsCGX+9Xuqo=" crossorigin="anonymous"></script>-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/3.0.4/socket.io.min.js"></script>
<script>
$(document).ready(function(){
    var competition_id = {{ competition_id }}

    var socket = io.connect();
    var selectedweightcategory = $('#weight_cat_select').children("option:selected").val();

    var weight_value = $('#myTextBox').val();
    // console.log("значение веса: ", weight_value);
    // console.log("значение селекта: ", selectedweightcategory);

    $("input.weight_value_at_reg").change(function (){
        // console.log('что-то изменилось в инпуте')
        // var new_weight_value = $(this).val();
        weight_value = $(this).val();
        // console.log('новая переменная ', weight_value)
    })


    $("select.weight_category_select").change(function(){
        selectedweightcategory = $(this).children("option:selected").val();
        // console.log("значение селекта после обновления селекта: ", selectedweightcategory);
        // alert("You have selected the country - " + selectedCountry);
    });

    $('.update_weight_cat').click(function(){
        //weight_value = $('#myTextBox').val();
        // console.log("значение в инпуте: ", weight_value)
        socket.emit('weight_value_changed', {'weight_new_value': weight_value, 'competition_id':competition_id});

        // console.log("значение селекта после нажатия на кнопку: ", selectedweightcategory, "competition_id: ", competition_id);
    });






       // Мы получили с сервера сообщение по каналу 'after connect'
        // Получив по каналу собщение мы отображаем его в консоли.
        socket.on('after connect', function(msg){
            console.log('After connect', msg.data);
        });

        socket.on('update_weight_category_select_value', function (msg){
            var select_updated_id = parseInt(msg.data)
            // console.log(msg.data)
            $(".weight_category_select").val(select_updated_id)

                // document.getElementById('timer_slave').innerHTML = timer_display(msg.timer_sent)
            })

});
</script>